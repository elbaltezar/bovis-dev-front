{"ast":null,"code":"/*! @azure/msal-browser v2.38.3 2023-10-27 */\n'use strict';\n\nimport { __extends, __awaiter, __generator, __assign } from '../_virtual/_tslib.js';\nimport { AuthError, PerformanceEvents, Constants } from '@azure/msal-common';\nimport { StandardInteractionClient } from './StandardInteractionClient.js';\nimport { BrowserAuthError } from '../error/BrowserAuthError.js';\nimport { InteractionType } from '../utils/BrowserConstants.js';\nimport { SilentHandler } from '../interaction_handler/SilentHandler.js';\nimport { HybridSpaAuthorizationCodeClient } from './HybridSpaAuthorizationCodeClient.js';\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\n\nvar SilentAuthCodeClient =\n/** @class */\nfunction (_super) {\n  __extends(SilentAuthCodeClient, _super);\n\n  function SilentAuthCodeClient(config, storageImpl, browserCrypto, logger, eventHandler, navigationClient, apiId, performanceClient, nativeMessageHandler, correlationId) {\n    var _this = _super.call(this, config, storageImpl, browserCrypto, logger, eventHandler, navigationClient, performanceClient, nativeMessageHandler, correlationId) || this;\n\n    _this.apiId = apiId;\n    return _this;\n  }\n  /**\r\n   * Acquires a token silently by redeeming an authorization code against the /token endpoint\r\n   * @param request\r\n   */\n\n\n  SilentAuthCodeClient.prototype.acquireToken = function (request) {\n    return __awaiter(this, void 0, void 0, function () {\n      var silentRequest, serverTelemetryManager, authCodeRequest, clientConfig, authClient, silentHandler, e_1;\n      return __generator(this, function (_a) {\n        switch (_a.label) {\n          case 0:\n            this.logger.trace(\"SilentAuthCodeClient.acquireToken called\"); // Auth code payload is required\n\n            if (!request.code) {\n              throw BrowserAuthError.createAuthCodeRequiredError();\n            } // Create silent request\n\n\n            this.performanceClient.setPreQueueTime(PerformanceEvents.StandardInteractionClientInitializeAuthorizationRequest, request.correlationId);\n            return [4\n            /*yield*/\n            , this.initializeAuthorizationRequest(request, InteractionType.Silent)];\n\n          case 1:\n            silentRequest = _a.sent();\n            this.browserStorage.updateCacheEntries(silentRequest.state, silentRequest.nonce, silentRequest.authority, silentRequest.loginHint || Constants.EMPTY_STRING, silentRequest.account || null);\n            serverTelemetryManager = this.initializeServerTelemetryManager(this.apiId);\n            _a.label = 2;\n\n          case 2:\n            _a.trys.push([2, 4,, 5]);\n\n            authCodeRequest = __assign(__assign({}, silentRequest), {\n              code: request.code\n            }); // Initialize the client\n\n            this.performanceClient.setPreQueueTime(PerformanceEvents.StandardInteractionClientGetClientConfiguration, request.correlationId);\n            return [4\n            /*yield*/\n            , this.getClientConfiguration(serverTelemetryManager, silentRequest.authority)];\n\n          case 3:\n            clientConfig = _a.sent();\n            authClient = new HybridSpaAuthorizationCodeClient(clientConfig);\n            this.logger.verbose(\"Auth code client created\");\n            silentHandler = new SilentHandler(authClient, this.browserStorage, authCodeRequest, this.logger, this.config.system, this.performanceClient); // Handle auth code parameters from request\n\n            return [2\n            /*return*/\n            , silentHandler.handleCodeResponseFromServer({\n              code: request.code,\n              msgraph_host: request.msGraphHost,\n              cloud_graph_host_name: request.cloudGraphHostName,\n              cloud_instance_host_name: request.cloudInstanceHostName\n            }, silentRequest.state, authClient.authority, this.networkClient, false)];\n\n          case 4:\n            e_1 = _a.sent();\n\n            if (e_1 instanceof AuthError) {\n              e_1.setCorrelationId(this.correlationId);\n            }\n\n            serverTelemetryManager.cacheFailedRequest(e_1);\n            this.browserStorage.cleanRequestByState(silentRequest.state);\n            throw e_1;\n\n          case 5:\n            return [2\n            /*return*/\n            ];\n        }\n      });\n    });\n  };\n  /**\r\n   * Currently Unsupported\r\n   */\n\n\n  SilentAuthCodeClient.prototype.logout = function () {\n    // Synchronous so we must reject\n    return Promise.reject(BrowserAuthError.createSilentLogoutUnsupportedError());\n  };\n\n  return SilentAuthCodeClient;\n}(StandardInteractionClient);\n\nexport { SilentAuthCodeClient };","map":{"version":3,"names":["__extends","__awaiter","__generator","__assign","AuthError","PerformanceEvents","Constants","StandardInteractionClient","BrowserAuthError","InteractionType","SilentHandler","HybridSpaAuthorizationCodeClient","SilentAuthCodeClient","_super","config","storageImpl","browserCrypto","logger","eventHandler","navigationClient","apiId","performanceClient","nativeMessageHandler","correlationId","_this","call","prototype","acquireToken","request","silentRequest","serverTelemetryManager","authCodeRequest","clientConfig","authClient","silentHandler","e_1","_a","label","trace","code","createAuthCodeRequiredError","setPreQueueTime","StandardInteractionClientInitializeAuthorizationRequest","initializeAuthorizationRequest","Silent","sent","browserStorage","updateCacheEntries","state","nonce","authority","loginHint","EMPTY_STRING","account","initializeServerTelemetryManager","trys","push","StandardInteractionClientGetClientConfiguration","getClientConfiguration","verbose","system","handleCodeResponseFromServer","msgraph_host","msGraphHost","cloud_graph_host_name","cloudGraphHostName","cloud_instance_host_name","cloudInstanceHostName","networkClient","setCorrelationId","cacheFailedRequest","cleanRequestByState","logout","Promise","reject","createSilentLogoutUnsupportedError"],"sources":["F:/Bovis/Front/bovis-dev/node_modules/@azure/msal-browser/dist/interaction_client/SilentAuthCodeClient.js"],"sourcesContent":["/*! @azure/msal-browser v2.38.3 2023-10-27 */\n'use strict';\nimport { __extends, __awaiter, __generator, __assign } from '../_virtual/_tslib.js';\nimport { AuthError, PerformanceEvents, Constants } from '@azure/msal-common';\nimport { StandardInteractionClient } from './StandardInteractionClient.js';\nimport { BrowserAuthError } from '../error/BrowserAuthError.js';\nimport { InteractionType } from '../utils/BrowserConstants.js';\nimport { SilentHandler } from '../interaction_handler/SilentHandler.js';\nimport { HybridSpaAuthorizationCodeClient } from './HybridSpaAuthorizationCodeClient.js';\n\n/*\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License.\r\n */\r\nvar SilentAuthCodeClient = /** @class */ (function (_super) {\r\n    __extends(SilentAuthCodeClient, _super);\r\n    function SilentAuthCodeClient(config, storageImpl, browserCrypto, logger, eventHandler, navigationClient, apiId, performanceClient, nativeMessageHandler, correlationId) {\r\n        var _this = _super.call(this, config, storageImpl, browserCrypto, logger, eventHandler, navigationClient, performanceClient, nativeMessageHandler, correlationId) || this;\r\n        _this.apiId = apiId;\r\n        return _this;\r\n    }\r\n    /**\r\n     * Acquires a token silently by redeeming an authorization code against the /token endpoint\r\n     * @param request\r\n     */\r\n    SilentAuthCodeClient.prototype.acquireToken = function (request) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var silentRequest, serverTelemetryManager, authCodeRequest, clientConfig, authClient, silentHandler, e_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this.logger.trace(\"SilentAuthCodeClient.acquireToken called\");\r\n                        // Auth code payload is required\r\n                        if (!request.code) {\r\n                            throw BrowserAuthError.createAuthCodeRequiredError();\r\n                        }\r\n                        // Create silent request\r\n                        this.performanceClient.setPreQueueTime(PerformanceEvents.StandardInteractionClientInitializeAuthorizationRequest, request.correlationId);\r\n                        return [4 /*yield*/, this.initializeAuthorizationRequest(request, InteractionType.Silent)];\r\n                    case 1:\r\n                        silentRequest = _a.sent();\r\n                        this.browserStorage.updateCacheEntries(silentRequest.state, silentRequest.nonce, silentRequest.authority, silentRequest.loginHint || Constants.EMPTY_STRING, silentRequest.account || null);\r\n                        serverTelemetryManager = this.initializeServerTelemetryManager(this.apiId);\r\n                        _a.label = 2;\r\n                    case 2:\r\n                        _a.trys.push([2, 4, , 5]);\r\n                        authCodeRequest = __assign(__assign({}, silentRequest), { code: request.code });\r\n                        // Initialize the client\r\n                        this.performanceClient.setPreQueueTime(PerformanceEvents.StandardInteractionClientGetClientConfiguration, request.correlationId);\r\n                        return [4 /*yield*/, this.getClientConfiguration(serverTelemetryManager, silentRequest.authority)];\r\n                    case 3:\r\n                        clientConfig = _a.sent();\r\n                        authClient = new HybridSpaAuthorizationCodeClient(clientConfig);\r\n                        this.logger.verbose(\"Auth code client created\");\r\n                        silentHandler = new SilentHandler(authClient, this.browserStorage, authCodeRequest, this.logger, this.config.system, this.performanceClient);\r\n                        // Handle auth code parameters from request\r\n                        return [2 /*return*/, silentHandler.handleCodeResponseFromServer({\r\n                                code: request.code,\r\n                                msgraph_host: request.msGraphHost,\r\n                                cloud_graph_host_name: request.cloudGraphHostName,\r\n                                cloud_instance_host_name: request.cloudInstanceHostName\r\n                            }, silentRequest.state, authClient.authority, this.networkClient, false)];\r\n                    case 4:\r\n                        e_1 = _a.sent();\r\n                        if (e_1 instanceof AuthError) {\r\n                            e_1.setCorrelationId(this.correlationId);\r\n                        }\r\n                        serverTelemetryManager.cacheFailedRequest(e_1);\r\n                        this.browserStorage.cleanRequestByState(silentRequest.state);\r\n                        throw e_1;\r\n                    case 5: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * Currently Unsupported\r\n     */\r\n    SilentAuthCodeClient.prototype.logout = function () {\r\n        // Synchronous so we must reject\r\n        return Promise.reject(BrowserAuthError.createSilentLogoutUnsupportedError());\r\n    };\r\n    return SilentAuthCodeClient;\r\n}(StandardInteractionClient));\n\nexport { SilentAuthCodeClient };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}